webpackJsonp([10],{"4Rv3":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a("aA9S"),i=a.n(o),r=/([yMdhsm])(\1*)/g;function s(t,e){for(var a=e-(t+"").length,o=0;o<a;o++)t="0"+t;return t}var l={format:function(t,e){return(e=e||"yyyy/MM/dd").replace(r,function(e){switch(e.charAt(0)){case"y":return s(t.getFullYear(),e.length);case"M":return s(t.getMonth()+1,e.length);case"d":return s(t.getDate(),e.length);case"w":return t.getDay()+1;case"h":return s(t.getHours(),e.length);case"m":return s(t.getMinutes(),e.length);case"s":return s(t.getSeconds(),e.length)}})},parse:function(t,e){var a=e.match(r),o=t.match(/(\d)+/g);if(a.length===o.length){for(var i=new Date(1970,0,1),s=0;s<a.length;s++){var l=parseInt(o[s]);switch(a[s].charAt(0)){case"y":i.setFullYear(l);break;case"M":i.setMonth(l-1);break;case"d":i.setDate(l);break;case"h":i.setHours(l);break;case"m":i.setMinutes(l);break;case"s":i.setSeconds(l)}}return i}return null}},n=a("6sKG"),d=a.n(n),c={data:function(){return{filters:{name:""},books:[],total:0,page:1,listLoading:!1,sels:[],editFormVisible:!1,editLoading:!1,editFormRules:{name:[{required:!0,message:"请输入书名",trigger:"blur"}],author:[{required:!0,message:"请输入作者",trigger:"blur"}],description:[{required:!0,message:"请输入简介",trigger:"blur"}]},editForm:{id:0,name:"",author:"",publishAt:"",description:""},addFormVisible:!1,addLoading:!1,addFormRules:{name:[{required:!0,message:"请输入书名",trigger:"blur"}],author:[{required:!0,message:"请输入作者",trigger:"blur"}],description:[{required:!0,message:"请输入简介",trigger:"blur"}]},addForm:{name:"",author:"",publishAt:"",description:""}}},methods:{handleCurrentChange:function(t){this.page=t,this.getBooks()},getBooks:function(){var t,e=this,a={page:this.page,name:this.filters.name};this.listLoading=!0,(t=a,d.a.get("/book/list",{params:t})).then(function(t){e.total=t.data.total,e.books=t.data.books,e.listLoading=!1})},selsChange:function(t){this.sels=t},delBook:function(t,e){var a=this;this.$confirm("确认删除该记录吗?","提示",{type:"warning"}).then(function(){a.listLoading=!0;var t,o={id:e.id};(t=o,d.a.get("/book/delete",{params:t})).then(function(t){a.listLoading=!1,a.$message({message:"删除成功",type:"success"}),a.getBooks()})}).catch(function(){})},showModal:function(t,e){alert(111)},showEditDialog:function(t,e){this.editFormVisible=!0,this.editForm=i()({},e)},editSubmit:function(){var t=this;this.$refs.editForm.validate(function(e){e&&t.$confirm("确认提交吗？","提示",{}).then(function(){t.editLoading=!0;var e,a=i()({},t.editForm);a.publishAt=a.publishAt&&""!=a.publishAt?l.format(new Date(a.publishAt),"yyyy-MM-dd"):"",(e=a,d.a.get("/book/edit",{params:e})).then(function(e){t.editLoading=!1,t.$message({message:"提交成功",type:"success"}),t.$refs.editForm.resetFields(),t.editFormVisible=!1,t.getBooks()})})})},showAddDialog:function(){this.addFormVisible=!0,this.addForm={name:"",author:"",publishAt:"",description:""}},addSubmit:function(){var t=this;this.$refs.addForm.validate(function(e){if(e){t.addLoading=!0;var a=i()({},t.addForm);a.publishAt=a.publishAt&&""!=a.publishAt?l.format(new Date(a.publishAt),"yyyy-MM-dd"):"",(o=a,d.a.get("/book/add",{params:o})).then(function(e){t.addLoading=!1,t.$message({message:"提交成功",type:"success"}),t.$refs.addForm.resetFields(),t.addFormVisible=!1,t.getBooks()})}var o})},batchDeleteBook:function(){var t=this,e=this.sels.map(function(t){return t.id}).toString();this.$confirm("确认删除选中记录吗？","提示",{type:"warning"}).then(function(){var a;t.listLoading=!0,(a={ids:e},d.a.get("/book/batchdelete",{params:a})).then(function(e){t.listLoading=!1,t.$message({message:"删除成功",type:"success"}),t.getBooks()})}).catch(function(){})}},mounted:function(){this.getBooks()}},u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-row",{staticClass:"warp"},[a("el-col",{staticClass:"warp-breadcrum",attrs:{span:24}}),t._v(" "),a("el-col",{staticClass:"warp-main",attrs:{span:24}},[a("el-col",{staticClass:"toolbar",staticStyle:{"padding-bottom":"0px"},attrs:{span:24}},[a("el-form",{attrs:{inline:!0,model:t.filters}},[a("el-form-item",[a("el-input",{attrs:{placeholder:"书名"},model:{value:t.filters.name,callback:function(e){t.$set(t.filters,"name",e)},expression:"filters.name"}})],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:t.getBooks}},[t._v("查询")])],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:t.showAddDialog}},[t._v("新增")])],1)],1)],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:t.books,"highlight-current-row":""},on:{"selection-change":t.selsChange}},[a("el-table-column",{attrs:{type:"selection"}}),t._v(" "),a("el-table-column",{attrs:{type:"expand",label:"简介"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"left",inline:""}},[a("el-form-item",{attrs:{label:"[图书简介]"}},[a("span",[t._v(t._s(e.row.description))])])],1)]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"name",label:"银行",sortable:""}}),t._v(" "),a("el-table-column",{attrs:{prop:"author",label:"信用卡",sortable:""}}),t._v(" "),a("el-table-column",{attrs:{prop:"publishAt",label:"出版日期",sortable:""}}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"small"},on:{click:function(a){t.showEditDialog(e.$index,e.row)}}},[t._v("编辑")]),t._v(" "),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(a){t.delBook(e.$index,e.row)}}},[t._v("删除")])]}}])})],1),t._v(" "),a("el-col",{staticClass:"toolbar",attrs:{span:24}},[a("el-button",{attrs:{type:"danger",disabled:0===this.sels.length},on:{click:t.batchDeleteBook}},[t._v("批量删除")]),t._v(" "),a("el-pagination",{staticStyle:{float:"right"},attrs:{layout:"prev, pager, next","page-size":10,total:t.total},on:{"current-change":t.handleCurrentChange}})],1),t._v(" "),a("el-dialog",{attrs:{title:"编辑",visible:t.editFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.editFormVisible=e}}},[a("el-form",{ref:"editForm",attrs:{model:t.editForm,"label-width":"100px",rules:t.editFormRules}},[a("el-form-item",{attrs:{label:"书名",prop:"name"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:t.editForm.name,callback:function(e){t.$set(t.editForm,"name",e)},expression:"editForm.name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"作者",prop:"author"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:t.editForm.author,callback:function(e){t.$set(t.editForm,"author",e)},expression:"editForm.author"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"出版日期"}},[a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},model:{value:t.editForm.publishAt,callback:function(e){t.$set(t.editForm,"publishAt",e)},expression:"editForm.publishAt"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"简介",prop:"description"}},[a("el-input",{attrs:{type:"textarea",rows:8},model:{value:t.editForm.description,callback:function(e){t.$set(t.editForm,"description",e)},expression:"editForm.description"}})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(e){t.editFormVisible=!1}}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{type:"primary",loading:t.editLoading},nativeOn:{click:function(e){return t.editSubmit(e)}}},[t._v("提交")])],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"新增",visible:t.addFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.addFormVisible=e}}},[a("el-form",{ref:"addForm",attrs:{model:t.addForm,"label-width":"80px",rules:t.addFormRules}},[a("el-form-item",{attrs:{label:"书名",prop:"name"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:t.addForm.name,callback:function(e){t.$set(t.addForm,"name",e)},expression:"addForm.name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"作者",prop:"author"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:t.addForm.author,callback:function(e){t.$set(t.addForm,"author",e)},expression:"addForm.author"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"出版日期"}},[a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},model:{value:t.addForm.publishAt,callback:function(e){t.$set(t.addForm,"publishAt",e)},expression:"addForm.publishAt"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"简介",prop:"description"}},[a("el-input",{attrs:{type:"textarea",rows:8},model:{value:t.addForm.description,callback:function(e){t.$set(t.addForm,"description",e)},expression:"addForm.description"}})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(e){t.addFormVisible=!1}}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{type:"primary",loading:t.addLoading},nativeOn:{click:function(e){return t.addSubmit(e)}}},[t._v("提交")])],1)],1)],1)],1)},staticRenderFns:[]};var m=a("vSla")(c,u,!1,function(t){a("wFN+")},null,null);e.default=m.exports},"wFN+":function(t,e){}});